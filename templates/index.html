<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeepPeryax</title>
    <script>
        function resetSelection() {
            const images = document.querySelectorAll("img[data-kind='0']");
            images.forEach(function(img) {
                img.src = "/static/images/0.png";
            });
        }

        var next_x = -1;
        var next_y = -1;
        var next_kind = 0;
        var kind_names = ["p", "s", "b"];

        document.addEventListener("DOMContentLoaded", function() {
            const images = document.querySelectorAll("img");
            images.forEach(function(img) {
                img.addEventListener("click", function() {
                    const x = parseInt(this.getAttribute("data-x"), 10);
                    const y = parseInt(this.getAttribute("data-y"), 10);
                    const kind = parseInt(this.getAttribute("data-kind"), 10);
                    if (kind !== 0) {
                        return;
                    }

                    if (next_x == x && next_y == y) {
                        next_kind = (next_kind + 1) % 3;
                    } else {
                        next_x = x;
                        next_y = y;
                        next_kind = 0;
                    }

                    resetSelection();
                    img.src = "/static/images/" + kind_names[next_kind] + ".png";
                });
            });
        });
    </script>
</head>
<body>
    {% if winner == "red" %}
        <p>Red is the winner</p>
    {% elif winner == "white" %}
        <p>White is the winner</p>
    {% endif %}
    <table>
        {% for row in board %}
            <tr>
                {% for cell in row %}
                    <td><img src="/static/images/{{ cell.kind }}.png" data-x="{{ cell.x }}" data-y="{{ cell.y }}" data-kind="{{ cell.kind }}"></td>
                {% endfor %}
            </tr>
        {% endfor %}
    </table>
</body>
</html>